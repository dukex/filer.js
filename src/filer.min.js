"use strict";var self=this;self.URL=self.URL||self.webkitURL;self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem;self.resolveLocalFileSystemURL=self.resolveLocalFileSystemURL||self.webkitResolveLocalFileSystemURL;navigator.temporaryStorage=navigator.temporaryStorage||navigator.webkitTemporaryStorage;navigator.persistentStorage=navigator.persistentStorage||navigator.webkitPersistentStorage;self.BlobBuilder=self.BlobBuilder||self.MozBlobBuilder||self.WebKitBlobBuilder;if(self.FileError===undefined){var FileError=function(){};FileError.prototype.prototype=Error.prototype}var Util={toArray:function(a){return Array.prototype.slice.call(a||[],0)},strToDataURL:function(b,d,c){var a=c!=undefined?c:true;if(a){return"data:"+d+";base64,"+self.btoa(b)}else{return"data:"+d+","+b}},strToObjectURL:function(a,e){var c=new Uint8Array(a.length);for(var d=0;d<c.length;++d){c[d]=a.charCodeAt(d)}var b=new Blob([c],e?{type:e}:{});return self.URL.createObjectURL(b)},fileToObjectURL:function(a){return self.URL.createObjectURL(a)},fileToArrayBuffer:function(b,d,c){var a=new FileReader();a.onload=function(f){d(f.target.result)};a.onerror=function(f){if(c){c(f)}};a.readAsArrayBuffer(b)},dataURLToBlob:function(g){var a=";base64,";if(g.indexOf(a)==-1){var f=g.split(",");var h=f[0].split(":")[1];var b=f[1];return new Blob([b],{type:h})}var f=g.split(a);var h=f[0].split(":")[1];var b=window.atob(f[1]);var e=b.length;var d=new Uint8Array(e);for(var c=0;c<e;++c){d[c]=b.charCodeAt(c)}return new Blob([d],{type:h})},arrayBufferToBlob:function(a,b){var c=new Uint8Array(a);return new Blob([c],b?{type:b}:{})},arrayBufferToBinaryString:function(b,e,d){var a=new FileReader();a.onload=function(f){e(f.target.result)};a.onerror=function(f){if(d){d(f)}};var c=new Uint8Array(b);a.readAsBinaryString(new Blob([c]))},arrayToBinaryString:function(b){if(typeof b!=typeof[]){return null}var c=b.length;var a=new Array(c);while(c--){a[c]=String.fromCharCode(b[c])}return a.join("")},getFileExtension:function(b){var a=b.lastIndexOf(".");return a!=-1?b.substring(a):""}};var MyFileError=function(a){this.prototype=FileError.prototype;this.code=a.code;this.name=a.name};FileError.BROWSER_NOT_SUPPORTED=1000;FileError.prototype.__defineGetter__("name",function(){var c=Object.keys(FileError);for(var b=0,a;a=c[b];++b){if(FileError[a]==this.code){return a}}return"Unknown Error"});var Filer=new function(){var h="Filesystem has not been initialized.";var j="Not implemented.";var e="Path was not a directory.";var n="These method arguments are not supported.";var m="filesystem:";var k=1024*1024;var a=null;var d=null;var g=false;var l=function(o){return o.indexOf(m)==0};var c=function(o){if(!l(o)){if(o[0]=="/"){o=a.root.toURL()+o.substring(1)}else{if(o.indexOf("./")==0||o.indexOf("../")==0){if(o=="../"&&d!=a.root){o=d.toURL()+"/"+o}else{o=d.toURL()+o}}else{o=d.toURL()+"/"+o}}}return o};var f=function(w,u,v){var p=arguments[2];var s=arguments[3];var r=u||function(x){throw x};var q=function(y){var x;if(y.code==FileError.NOT_FOUND_ERR){if(s){x=new Error('"'+p+'" or "'+s+'" does not exist.')}else{x=new Error('"'+p+'" does not exist.')}}else{x=new Error("Problem getting Entry for one or more paths.")}x.code=y.code;r(x);return};var o=c(p);if(arguments.length==4){var t=c(s);self.resolveLocalFileSystemURL(o,function(x){self.resolveLocalFileSystemURL(t,function(y){w(x,y)},q)},q)}else{self.resolveLocalFileSystemURL(o,w,q)}};var b=function(o,t,u,w,s,q){var v=this;if(!a){throw new Error(h)}if(typeof o!=typeof t){throw new Error(n)}var r=u||null;var p=q!=undefined?q:false;if((o.isFile||t.isDirectory)&&t.isDirectory){if(p){o.moveTo(t,r,w,s)}else{o.copyTo(t,r,w,s)}}else{f(function(x,y){if(!y.isDirectory){var z=new Error('Oops! "'+y.name+" is not a directory!");if(s){s(z)}else{throw z}return}if(p){x.moveTo(y,r,w,s)}else{x.copyTo(y,r,w,s)}},s,o,t)}};function i(o){a=o||null;if(a){d=a.root;g=true}}i.DEFAULT_FS_SIZE=k;i.version="0.4.3";i.prototype={get fs(){return a},get isOpen(){return g},get cwd(){return d}};i.prototype.pathToFilesystemURL=function(o){return c(o)};i.prototype.init=function(r,o,t){if(!self.requestFileSystem){throw new MyFileError({code:FileError.BROWSER_NOT_SUPPORTED,name:"BROWSER_NOT_SUPPORTED"})}var p=r?r:{};var q=p.size||k;this.type=self.TEMPORARY;if("persistent" in p&&p.persistent){this.type=self.PERSISTENT}var s=function(u){this.size=q;a=u;d=a.root;g=true;o&&o(u)};if(this.type==self.PERSISTENT&&!!navigator.persistentStorage){navigator.persistentStorage.requestQuota(q,function(u){self.requestFileSystem(this.type,u,s.bind(this),t)}.bind(this),t)}else{self.requestFileSystem(this.type,q,s.bind(this),t)}};i.prototype.ls=function(p,o,q){if(!a){throw new Error(h)}var r=function(v){var u=[];var s=v.createReader();var t=function(){s.readEntries(function(w){if(!w.length){u.sort(function(y,x){return y.name<x.name?-1:x.name<y.name?1:0});o(u)}else{u=u.concat(Util.toArray(w));t()}},q)};t()};if(p.isDirectory){r(p)}else{if(l(p)){f(r,q,c(p))}else{d.getDirectory(p,{},r,q)}}};i.prototype.mkdir=function(q,t,o,s){if(!a){throw new Error(h)}var r=t!=null?t:false;var p=q.split("/");var u=function(v,w){if(w[0]=="."||w[0]==""){w=w.slice(1)}v.getDirectory(w[0],{create:true,exclusive:r},function(x){if(x.isDirectory){if(w.length&&p.length!=1){u(x,w.slice(1))}else{if(o){o(x)}}}else{var y=new Error(q+" is not a directory");if(s){s(y)}else{throw y}}},function(x){x.message=x.message||"'"+q+"' already exists";if(s){s(x)}else{throw x}})};u(d,p)};i.prototype.open=function(p,o,q){if(!a){throw new Error(h)}if(p.isFile){p.file(o,q)}else{f(function(r){r.file(o,q)},q,c(p))}};i.prototype.getEntry=function(p,o,q){if(!a){throw new Error(h)}f(o,q,c(p))};i.prototype.create=function(p,s,o,r){if(!a){throw new Error(h)}var q=s!=null?s:true;d.getFile(p,{create:true,exclusive:q},o,function(t){if(t.code==FileError.INVALID_MODIFICATION_ERR){t.message="'"+p+"' already exists"}if(r){r(t)}else{throw t}})};i.prototype.mv=function(s,p,q,o,r){b.bind(this,s,p,q,o,r,true)()};i.prototype.rm=function(p,o,r){if(!a){throw new Error(h)}var q=function(s){if(s.isFile){s.remove(o,r)}else{if(s.isDirectory){s.removeRecursively(o,r)}}};if(p.isFile||p.isDirectory){q(p)}else{f(q,r,p)}};i.prototype.cd=function(p,o,q){if(!a){throw new Error(h)}if(p.isDirectory){d=p;o&&o(d)}else{var p=c(p);f(function(r){if(r.isDirectory){d=r;o&&o(d)}else{var s=new Error(e);if(q){q(s)}else{throw s}}},q,p)}};i.prototype.cp=function(s,p,q,o,r){b.bind(this,s,p,q,o,r)()};i.prototype.write=function(q,p,o,s){if(!a){throw new Error(h)}var r=function(t){t.createWriter(function(w){w.onerror=s;if(p.append){w.onwriteend=function(x){if(o){o(t,this)}};w.seek(w.length)}else{var v=false;w.onwriteend=function(x){if(!v){v=true;this.truncate(this.position);return}if(o){o(t,this)}}}if(p.data.__proto__==ArrayBuffer.prototype){p.data=new Uint8Array(p.data)}var u=new Blob([p.data],p.type?{type:p.type}:{});w.write(u)},s)};if(q.isFile){r(q)}else{if(l(q)){f(r,s,q)}else{d.getFile(q,{create:true,exclusive:false},r,s)}}};i.prototype.df=function(o,q){var p=function(s,r){o(s,r-s,r)};if(!(navigator.temporaryStorage.queryUsageAndQuota&&navigator.persistentStorage.queryUsageAndQuota)){throw new Error(j)}if(self.TEMPORARY==this.type){navigator.temporaryStorage.queryUsageAndQuota(p,q)}else{if(self.PERSISTENT==this.type){navigator.persistentStorage.queryUsageAndQuota(p,q)}}};return i};